define(function(require,exports,module){var _=require("underscore");var Backbone=require("backbone");var MypublishListModel=Backbone.Model.extend({});var MypublishListCollection=Backbone.Collection.extend({model:MypublishListModel,setPage:function(page,uid){this.url="/user/getMyPublish?uid="+uid+"&pageid="+page;return this},initialize:function(){this.setPage(1,27)}});var MypublishList=new MypublishListCollection;window.Mypublish=MypublishList;var MypublishViewDef=Backbone.View.extend({el:"#my-publish",events:{"tap #my-publish .load-more":"loadMore","tap #mypublish-main li":"showDetail"},homeListTemplate:_.template($("#tmpl-mypublish-items").html()),initialize:function(){$.ui.showMask("正在加载发布内容列表...");Mypublish.on("reset",this.renderMypublish,this);this.page=1;this.uid=27;this.pull()},pull:function(){Mypublish.setPage(this.page++,this.uid).fetch({success:function(){$.ui.hideMask()},error:function(){$.ui.hideMask();$.ui.popup({title:"错误信息",message:"服务器异常, 或许数据解析错误，请稍候重试！",doneText:"确认",doneCallback:function(){},cancelText:"取消"})}})},renderMypublish:function(list){if(list.length===0||list.length<11){$("#my-publish .load-more").hide()}var _data=list.toJSON()[0].body.data;var _html=this.homeListTemplate({data:_data});$("#mypublish-main").append(_html)},loadMore:function(){this.pull()},showDetail:function(e){var _e=$(e.currentTarget);var _id=_e.attr("data-id");require.async("./case-detail",function(mod){mod.showArticle(_id)})}});new MypublishViewDef});